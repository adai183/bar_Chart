<!DOCTYPE html>
<meta charset="utf-8">

<head>
	<style>
body{
	background-color: black;
}


	</style>
</head>

<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>

<script>
var a = parseInt(Math.random() * 100),
		b = parseInt(Math.random() * 100),
		c = parseInt(Math.random() * 100),
		d = parseInt(Math.random() * 100);

var dataset =[a, b, c, d];

var updateData = function(){
	a = parseInt(Math.random() * 100),
	b = parseInt(Math.random() * 100),
	c = parseInt(Math.random() * 100),
	d = parseInt(Math.random() * 100);
	dataset = [a, b, c, d];
	console.log(dataset);
};

// simullate live data input
var update = setInterval(updateData, 1000);

//Width and height
var windowWidth = $(window).width();
var windowHeight = $(window).height();
var w = windowWidth * 98/100;
var h = windowHeight * 98/100;
var barPadding = windowWidth * 5/100;
var bottomRectHight = w * 6/100;
var y = d3.scale.sqrt()
    .range([h, 0])
		.domain([0,100]);//since values vary between 0 and 100


//Create SVG element
var svg = d3.select("body")
	.append("svg")
	.attr("width", w)
	.attr("height", h);

console.log(dataset);

//Draw static Rectangle
var rectangle = svg.append("rect")
	.attr("x", 0)
	.attr("y", h - bottomRectHight)
	.attr("width", w)
	.attr("height", bottomRectHight)
	.attr("fill", "rgb(250, 128, 114)");

	svg.selectAll(".input")
		.data(dataset)
		.enter()
		.append("rect")
		.attr("class", "input")
		.attr("fill", "rgb(250, 128, 114)")
		.attr("x", function(d, i) {
			return i * (w / dataset.length) + 2.5/100 * w;
		})
		.attr("y",  function(d) {
			return h;
		})
		.attr("width", w / dataset.length - barPadding)
		.attr("height", y(0))
		.transition().duration(1750).ease("linear")
		.attr("y",  function(d) {
			return y(d);
		})
		.attr("height", function(d) {
			return h - y(d);
	});

var updateVis = function(){
	svg.selectAll(".input")
	.data(dataset)
	.transition().duration(1750).ease("linear")
	.attr("y",  function(d) {
		return y(d);
		})
	.attr("height", function(d) {
		return h - y(d);
	});
};
var updateLoop = setInterval(updateVis, 2000);

</script>

</body>
